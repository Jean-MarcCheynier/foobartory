(this.webpackJsonpfoobartory=this.webpackJsonpfoobartory||[]).push([[0],{15:function(t,n,o){t.exports={Robot:"Robot_Robot__20z7S","Robot-icon":"Robot_Robot-icon__3wKUB","Robot-icon--fooMining":"Robot_Robot-icon--fooMining__JNAwy","Robot-icon--barMining":"Robot_Robot-icon--barMining__1z6Ki","Robot-icon--foobarCrafting":"Robot_Robot-icon--foobarCrafting__-lEC6","Robot-icon--shopping":"Robot_Robot-icon--shopping__1GmDx","Robot-icon--benching":"Robot_Robot-icon--benching__17nsq","Robot-icon--changing":"Robot_Robot-icon--changing__fwp6y",ButtonGroup:"Robot_ButtonGroup__p1Dbv",Button:"Robot_Button__1V4TY","Button--fooMining":"Robot_Button--fooMining__EA70g","Button--barMining":"Robot_Button--barMining__2g9Eb","Button--foobarCrafting":"Robot_Button--foobarCrafting__3mMBF","Button--shopping":"Robot_Button--shopping__lDcRB","Button--benching":"Robot_Button--benching__26Lra"}},22:function(t,n,o){t.exports={Line:"Factory_Line__2MebV",LineFooMining:"Factory_LineFooMining__1LGpf",LineBarMining:"Factory_LineBarMining__2urO2",LineFoobarCrafting:"Factory_LineFoobarCrafting__2IPW5",LineShopping:"Factory_LineShopping__2iTbF",LineBenching:"Factory_LineBenching__1YwS7"}},26:function(t,n,o){t.exports={RobotIcon:"RobotIconActive_RobotIcon__3Nvfs","RobotIcon--fooMining":"RobotIconActive_RobotIcon--fooMining__2PeYP","RobotIcon--barMining":"RobotIconActive_RobotIcon--barMining__wwH9S",mineIn:"RobotIconActive_mineIn__3wpsZ",mineOut:"RobotIconActive_mineOut__2wix_","RobotIcon--spinning":"RobotIconActive_RobotIcon--spinning__TzoZX",spin:"RobotIconActive_spin__1edAg"}},42:function(t,n,o){},43:function(t,n,o){},51:function(t,n,o){"use strict";o.r(n);var e=o(1),r=o.n(e),c=o(11),a=o.n(c),i=(o(42),o(43),o(55)),s=o(56),b=o(7),u=o(17),l=o(3),d=o(13),j=o.n(d),f=o(21),h=o(9),p=o(12),O=5e3,g=1e3,v=600,x=2e3,_=3e3,m=1,y=1,R=.6,N=6,I=2,M=0,B=0,w=20,C=o(20),F=o(59),L=function t(){Object(C.a)(this,t)};function A(){var t={};return new Promise((function(n){return setTimeout((function(){return n({data:t})}),g)}))}function G(){var t={};return new Promise((function(n){var o=Math.random()*(x-v)+v;setTimeout((function(){return n({data:t})}),o)}))}L.createRobot=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:k.BENCH;return{id:Object(F.a)(),busy:!1,changingActivity:!1,activity:t}};var k,P={count:0,start:!1},S=null,H=function(){return function(t,n){S||(S=setInterval((function(){t(W())}),1e3))}},T=function(){return function(t,n){S&&(clearInterval(S),S=null)}},E=Object(p.c)({name:"counter",initialState:P,reducers:{increment:function(t){t.count+=1},storeIntervalId:function(t,n){return Object(l.a)(Object(l.a)({},t),{},{intervalId:n.payload})},reset:function(){return P}}}),z=E.actions,W=z.increment,Y=(z.storeIntervalId,z.reset),D=function(t){return t.counter.count},J=E.reducer;!function(t){t.FOO_MINING="fooMining",t.BAR_MINING="barMining",t.FOOBAR_CRAFTING="foobarCrafting",t.SHOPPING="shopping",t.BENCH="benching"}(k||(k={}));var K=function(){for(var t,n={producing:!1,robotMap:{},line:(t={},Object(h.a)(t,k.FOO_MINING,[]),Object(h.a)(t,k.BAR_MINING,[]),Object(h.a)(t,k.FOOBAR_CRAFTING,[]),Object(h.a)(t,k.SHOPPING,[]),Object(h.a)(t,k.BENCH,[]),t),prod:{foo:[],bar:[],foobar:[]},workshop:{craft:[],craftAttempts:0}},o=0;o<M;o++)n.prod.foo.push({});for(var e=0;e<B;e++)n.prod.bar.push({});for(var r=0;r<I;r++){var c=L.createRobot();n.robotMap[c.id]=c,n.line[k.BENCH].push(c.id)}return n},U=Object(p.b)("action/changeLine",function(){var t=Object(f.a)(j.a.mark((function t(n,o){var e;return j.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return(e=o.dispatch)(H()),e(nt()),t.next=5,new Promise((function(t){return setTimeout((function(){return t()}),O)}));case 5:return t.abrupt("return");case 6:case"end":return t.stop()}}),t)})));return function(n,o){return t.apply(this,arguments)}}()),V=Object(p.b)("action/mineFoo",function(){var t=Object(f.a)(j.a.mark((function t(n){var o;return j.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,A();case 2:return o=t.sent,t.abrupt("return",o.data);case 4:case"end":return t.stop()}}),t)})));return function(n){return t.apply(this,arguments)}}()),Z=Object(p.b)("action/mineBar",function(){var t=Object(f.a)(j.a.mark((function t(n){var o;return j.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,G();case 2:return o=t.sent,t.abrupt("return",o.data);case 4:case"end":return t.stop()}}),t)})));return function(n){return t.apply(this,arguments)}}()),q=Object(p.b)("action/craftFoobar",function(){var t=Object(f.a)(j.a.mark((function t(n,o){var e;return j.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,new Promise((function(t,n){return setTimeout((function(){Math.random()<R?t({data:{}}):n()}),_)}));case 2:return e=t.sent,t.abrupt("return",e.data);case 4:case"end":return t.stop()}}),t)})));return function(n,o){return t.apply(this,arguments)}}()),X=Object(p.b)("action/buyRobot",function(){var t=Object(f.a)(j.a.mark((function t(n,o){var e,r,c,a,i;return j.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e=o.getState,r=o.dispatch,t.next=3,new Promise((function(t,n){t({data:L.createRobot()})}));case 3:return c=t.sent,a=e(),i=a.factory,Object.entries(i.robotMap).length>=w-1&&(r(ot()),r(T())),t.abrupt("return",c.data);case 7:case"end":return t.stop()}}),t)})));return function(n,o){return t.apply(this,arguments)}}()),$=Object(p.c)({name:"factory",initialState:K(),reducers:{reset:function(){return K()},startProduction:function(t){return Object(l.a)(Object(l.a)({},t),{},{producing:!0})},stopProduction:function(t){return Object(l.a)(Object(l.a)({},t),{},{producing:!1})}},extraReducers:function(t){t.addCase(V.pending,(function(t,n){var o=n.meta.arg.robot;t.robotMap[o.id].busy=!0})).addCase(V.fulfilled,(function(t,n){var o=n.meta.arg.robot;t.prod.foo=[].concat(Object(u.a)(t.prod.foo),[n.payload]),t.robotMap[o.id].busy=!1})).addCase(Z.pending,(function(t,n){var o=n.meta.arg.robot;t.robotMap[o.id].busy=!0})).addCase(Z.fulfilled,(function(t,n){var o=n.meta.arg.robot;t.prod.bar=[].concat(Object(u.a)(t.prod.bar),[n.payload]),t.robotMap[o.id].busy=!1})).addCase(q.pending,(function(t,n){var o=n.meta.arg.robot;if(t.prod.bar.length<y||t.prod.bar.length<y)throw Error("Cannot perform reducer craftFoobar");t.robotMap[o.id].busy=!0;var e=t.prod.foo.splice(0,m),r=t.prod.bar.splice(0,y);t.workshop.craftAttempts++,t.workshop.craft.push({foos:e,bars:r})})).addCase(q.fulfilled,(function(t,n){var o=n.meta.arg.robot;t.workshop.craft.length<=0||(t.workshop.craft.pop(),t.prod.foobar.push({})),t.robotMap[o.id].busy=!1})).addCase(q.rejected,(function(t,n){var o=n.meta.arg.robot;if(t.workshop.craft.length<=0);else{var e=t.workshop.craft.pop();if(!e)throw new Error("Cannot reuse Bar");var r=e.bars;t.prod.bar=[].concat(Object(u.a)(t.prod.bar),Object(u.a)(r))}t.robotMap[o.id].busy=!1})).addCase(X.pending,(function(t,n){t.prod.foobar.splice(0,N)})).addCase(X.fulfilled,(function(t,n){var o=L.createRobot();t.robotMap[o.id]=o,t.line[k.BENCH].push(o.id)})).addCase(U.pending,(function(t,n){var o=n.meta.arg,e=o.robot,r=o.line,c=t.robotMap[e.id];c.activity&&(t.line[c.activity]=t.line[c.activity].filter((function(t){return t!==c.id}))),t.robotMap[c.id]=Object(l.a)(Object(l.a)({},t.robotMap[c.id]),{},{changingActivity:!0,activity:r}),t.line[r].push(c.id)})).addCase(U.fulfilled,(function(t,n){var o=n.meta.arg,e=o.robot,r=o.line;t.robotMap[e.id]=Object(l.a)(Object(l.a)({},t.robotMap[e.id]),{},{changingActivity:!1,activity:r})}))}}),Q=$.actions,tt=Q.reset,nt=Q.startProduction,ot=Q.stopProduction,et=function(t,n){return t.factory.line[n].map((function(n){return t.factory.robotMap[n]}))},rt=function(t){return et(t,k.FOO_MINING)},ct=function(t){return et(t,k.BAR_MINING)},at=function(t){return et(t,k.FOOBAR_CRAFTING)},it=function(t){return et(t,k.SHOPPING)},st=function(t){return et(t,k.BENCH)},bt=function(t){return t.factory.robotMap},ut=function(t){return t.factory.prod},lt=function(t){return t.factory.workshop},dt=function(t){return Object.entries(t.factory.robotMap).length>=w},jt=$.reducer,ft=o(4),ht=o(60),pt=o(54),Ot=o(28),gt=o(15),vt=o.n(gt),xt=o(26),_t=o.n(xt),mt=o(31),yt=o(33),Rt=o(2),Nt=function(t){var n,o=t.line,e="".concat(_t.a.RobotIcon," ").concat(_t.a["RobotIcon--".concat(o)]);switch(o){case k.FOO_MINING:case k.BAR_MINING:n=mt.a;break;case k.FOOBAR_CRAFTING:n=mt.b;break;case k.SHOPPING:n=Ot.b;break;default:n=yt.a,e="".concat(_t.a.RobotIcon," ").concat(_t.a["RobotIcon--spinning"])}return Object(Rt.jsx)(n,{className:e})},It=o(61),Mt=function(t){var n=t.line,o=t.activeLine,e=t.onChangeLine,r=t.children;return Object(Rt.jsx)(It.a,{"aria-label":"go-to-".concat(n),className:"".concat(vt.a.Button," ").concat(vt.a["Button--".concat(n)]),disabled:o===n,onClick:function(){return e(n)},children:r})},Bt=function(t){var n=Object(e.useRef)([]),o=t.activity,r=t.busy,c=t.changingActivity,a=t.changeLine,i=r||c,s=Object(e.useCallback)((function(){var n=t.action,o=Object(ft.a)(t,["action"]);n&&n({robot:o})}),[t]),b=function(o){if(void 0!==a){var e={robot:t,line:o};i?(r=function(){a(e)},n.current.push(r)):a(e)}var r};return Object(e.useEffect)((function(){if(!i){var t=n.current.shift();t?t():s()}}),[s,i]),Object(Rt.jsxs)(ht.a,{role:"robot",className:vt.a.Robot,children:[Object(Rt.jsxs)("div",{className:"".concat(vt.a["Robot-icon"]," ").concat(vt.a["Robot-icon--".concat(c?"changing":o)]),children:[Object(Rt.jsx)(Ot.a,{size:70}),o&&r?Object(Rt.jsx)(Nt,{line:o}):Object(Rt.jsx)(Nt,{line:k.BENCH})]}),Object(Rt.jsxs)("div",{className:"w-100",children:[Object(Rt.jsxs)(pt.a,{size:"sm",className:vt.a.ButtonGroup,"aria-label":"robot-control",children:[Object(Rt.jsx)(Mt,{line:k.FOO_MINING,activeLine:o,onChangeLine:b,children:"Foo"}),Object(Rt.jsx)(Mt,{line:k.BAR_MINING,activeLine:o,onChangeLine:b,children:"Bar"})]}),Object(Rt.jsxs)(pt.a,{size:"sm",className:vt.a.ButtonGroup,"aria-label":"robot-control",children:[Object(Rt.jsx)(Mt,{line:k.FOOBAR_CRAFTING,activeLine:o,onChangeLine:b,children:"Craft"}),Object(Rt.jsx)(Mt,{line:k.SHOPPING,activeLine:o,onChangeLine:b,children:"Shop"})]})]})]})},wt={changeLine:U},Ct=Object(b.b)((function(t){return{producing:t.factory.producing}}),wt)((function(t){var n=t.robotList,o=t.activity,e=t.producing,r=t.activityName,c=t.changeLine;return Object(Rt.jsxs)("div",{role:"line","aria-label":"line-".concat(r),className:"mx-auto my-1",children:[r&&Object(Rt.jsx)("h4",{className:"text-center w-100",children:r}),n.map((function(t,n){return Object(Rt.jsx)(Bt,Object(l.a)(Object(l.a)({},t),{},{action:e?o:void 0,changeLine:c}),n)}))]})})),Ft={activity:Z},Lt=Object(b.b)((function(t){return{activityName:k.BAR_MINING,robotList:ct(t)}}),Ft)(Ct),At={activity:V},Gt=Object(b.b)((function(t){return{activityName:k.FOO_MINING,robotList:rt(t)}}),At)(Ct),kt=function(t,n){return function(o){var e=o.activity,r=Object(ft.a)(o,["activity"]),c=Object(b.c)(n);return Object(Rt.jsx)(t,Object(l.a)({activity:c?e:void 0},r))}},Pt={activity:q},St=kt(Ct,(function(t){return t.factory.prod.foo.length>=m&&t.factory.prod.bar.length>=y})),Ht=Object(b.b)((function(t){return{activityName:k.FOOBAR_CRAFTING,prod:ut,robotList:at(t)}}),Pt)(St),Tt={activity:X},Et=Object(b.b)((function(t){return{activityName:k.SHOPPING,robotList:it(t)}}),Tt)(kt(Ct,(function(t){return t.factory.prod.foobar.length>=N}))),zt=Object(b.b)((function(t){return{activityName:k.BENCH,robotList:st(t)}}))(Ct),Wt=o(22),Yt=o.n(Wt),Dt=Object(b.b)((function(t){return{prod:ut(t),robotMap:bt(t)}}))((function(t){t.prod;return Object(Rt.jsx)(Rt.Fragment,{children:Object(Rt.jsxs)(i.a,{className:"h-75",children:[Object(Rt.jsx)(s.a,{className:Yt.a.LineFooMining,children:Object(Rt.jsx)(Gt,{})}),Object(Rt.jsx)(s.a,{className:Yt.a.LineBarMining,children:Object(Rt.jsx)(Lt,{})}),Object(Rt.jsx)(s.a,{className:Yt.a.LineFoobarCrafting,children:Object(Rt.jsx)(Ht,{})}),Object(Rt.jsx)(s.a,{className:Yt.a.LineShopping,children:Object(Rt.jsx)(Et,{})}),Object(Rt.jsx)(s.a,{className:Yt.a.LineBenching,children:Object(Rt.jsx)(zt,{})})]})})})),Jt=o(57),Kt={startCounter:H,stopCounter:T},Ut=Object(b.b)((function(t){return{start:t.factory.producing,count:D(t)}}),Kt)((function(t){var n=t.count,o=(t.start,t.startCounter,t.stopCounter,Math.round(n/60).toString()),e=(n%60).toString(),r=function(t){return 0===t.length?"00":1===t.length?"0".concat(t):t};return Object(Rt.jsx)("strong",{className:"test-primary",children:"".concat(r(o),":").concat(r(e))})})),Vt=Object(b.b)((function(t){return{robotMap:bt(t),prod:ut(t),workshop:lt(t)}}))((function(t){var n=t.prod,o=(t.workshop,t.robotMap);return Object(Rt.jsxs)(Jt.a,{className:"fixed-bottom",children:[Object(Rt.jsxs)(i.a,{className:"text-center bg-secondary",children:[Object(Rt.jsx)(s.a,{children:Object(Rt.jsx)("div",{children:Object(Rt.jsxs)("strong",{children:["FOO : ",Object(Rt.jsx)("span",{role:"counter","aria-label":"foo count",children:n.foo.length})]})})}),Object(Rt.jsx)(s.a,{children:Object(Rt.jsx)("div",{children:Object(Rt.jsxs)("strong",{children:["BAR:  ",Object(Rt.jsx)("span",{role:"counter","aria-label":"bar count",children:n.bar.length})]})})}),Object(Rt.jsx)(s.a,{children:Object(Rt.jsx)("div",{children:Object(Rt.jsxs)("strong",{children:["FOOBAR: ",Object(Rt.jsx)("span",{role:"counter","aria-label":"foobar count",children:n.foobar.length})]})})}),Object(Rt.jsx)(s.a,{children:Object(Rt.jsx)("div",{children:Object(Rt.jsxs)("strong",{children:["PRICE (FOOBAR): ",Object(Rt.jsx)("span",{role:"label","aria-label":"foobar price",children:N})]})})}),Object(Rt.jsx)(s.a,{children:Object(Rt.jsx)("div",{children:Object(Rt.jsxs)("strong",{children:["Number of robots: ",Object(Rt.jsx)("span",{role:"counter","aria-label":"robot count",children:"".concat(Object.entries(o).length," / ").concat(w)})]})})})]}),Object(Rt.jsx)(i.a,{className:"text-center bg-secondary",children:Object(Rt.jsx)(s.a,{children:Object(Rt.jsx)("div",{className:"w-100",children:Object(Rt.jsx)(Ut,{})})})})]})})),Zt=o(8),qt=o(58),Xt=function(){var t=Object(e.useState)(!0),n=Object(Zt.a)(t,2),o=n[0],r=n[1],c=function(){return r(!1)};return Object(Rt.jsxs)(qt.a,{show:o,onHide:c,children:[Object(Rt.jsx)(qt.a.Header,{closeButton:!0,children:Object(Rt.jsx)(qt.a.Title,{children:"Foobartory rules"})}),Object(Rt.jsxs)(qt.a.Body,{children:[Object(Rt.jsx)("strong",{children:"Try to get ".concat(w," robots as fast as you can")}),Object(Rt.jsx)("div",{children:"In each production line of the foobartory robots can perform a different action in a specific time lapse. They can :  "}),Object(Rt.jsxs)("ul",{children:[Object(Rt.jsx)("li",{children:"Mine 'Foo' on the blue line (cost ".concat(g/1e3," seconds)")}),Object(Rt.jsx)("li",{children:"Mine 'Bar' on the red line (const ".concat(v/1e3," to ").concat(x/1e3," seconds)")}),Object(Rt.jsx)("li",{children:"Asemble a 'Foo' and a 'Bar' on the purple line to craft a 'Foobar'. ( cost ".concat(_/1e3," seconds, and ").concat(100*R,"% chance of success. If it fails, the 'Foo' is lost)")}),Object(Rt.jsx)("li",{children:"Buy new robots on the green line (cost ".concat(N," 'foobars'), 0 seconds")})]}),Object(Rt.jsx)("div",{children:"Use the buttons of the robot to change production line, the robot needs ".concat(O/1e3," seconds to change activity. The timer will start when the first robot is on a line.")})]}),Object(Rt.jsx)(qt.a.Footer,{children:Object(Rt.jsx)(It.a,{onClick:c,variant:"primary",children:"Let's play"})})]})},$t={resetCounter:Y,resetFactory:tt},Qt=Object(b.b)((function(t){return{show:dt(t)}}),$t)((function(t){var n=t.show,o=t.resetCounter,e=t.resetFactory,r=function(){o(),e()};return Object(Rt.jsxs)(qt.a,{show:n,onHide:r,children:[Object(Rt.jsxs)(qt.a.Body,{children:[Object(Rt.jsx)("h3",{className:"text-primary",children:"You Won!"}),Object(Rt.jsx)("div",{className:"text-primary",children:Object(Rt.jsx)(Ut,{})})]}),Object(Rt.jsx)(qt.a.Footer,{children:Object(Rt.jsx)(It.a,{onClick:r,variant:"primary",children:"Play again"})})]})}));var tn=function(){return Object(Rt.jsxs)(Jt.a,{className:"h-100",children:[Object(Rt.jsx)(Xt,{}),Object(Rt.jsx)(Qt,{}),Object(Rt.jsx)(Dt,{}),Object(Rt.jsx)(Vt,{})]})},nn={counter:J,factory:jt},on=Object(p.a)({reducer:nn});Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));a.a.render(Object(Rt.jsx)(r.a.StrictMode,{children:Object(Rt.jsx)(b.a,{store:on,children:Object(Rt.jsx)(tn,{})})}),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(t){t.unregister()})).catch((function(t){console.error(t.message)}))}},[[51,1,2]]]);
//# sourceMappingURL=main.3cd68f5c.chunk.js.map